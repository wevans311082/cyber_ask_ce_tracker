{% extends "tracker/base.html" %}
{% load i18n %}

{% block title %}{{ title|default:"Assessments Awaiting Scheduling" }}{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2 class="mb-4">{{ title|default:"Assessments Awaiting Scheduling" }}</h2>

    <p class="text-muted">
        {% blocktrans %}
        This page lists assessments that require a date to be agreed upon and confirmed,
        or where the 'Agree Date' workflow step has not yet been marked as complete.
        {% endblocktrans %}
    </p>

    {% if assessments_awaiting_scheduling %}
    <div class="card mt-3">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover mb-0">
                    <thead class="table-light">
                        <tr>
                            <th scope="col">{% trans "Assessment ID" %}</th>
                            <th scope="col">{% trans "Client" %}</th>
                            <th scope="col">{% trans "Type" %}</th>
                            <th scope="col">{% trans "Assigned Assessor" %}</th>
                            <th scope="col">{% trans "Current Status" %}</th>
                            <th scope="col">{% trans "Start Date (if set)" %}</th>
                            <th scope="col">{% trans "Actions" %}</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for assessment in assessments_awaiting_scheduling %}
                        <tr>
                            <td>
                                {# Assuming you have an assessment_detail view for admins #}
                                {# <a href="{% url 'tracker:admin_assessment_detail' assessment.pk %}">{{ assessment.assessment_id }}</a> #}
                                {{ assessment.assessment_id }}
                            </td>
                            <td>
                                {% if assessment.client %}
                                    {{ assessment.client.name }}
                                    {# <a href="{% url 'tracker:client_detail' assessment.client.pk %}">{{ assessment.client.name }}</a> #}
                                {% else %}
                                    <span class="text-muted">{% trans "N/A" %}</span>
                                {% endif %}
                            </td>
                            <td>{{ assessment.get_assessment_type_display|default:"N/A" }}</td>
                            <td>
                                {% if assessment.assigned_assessor %}
                                    {{ assessment.assigned_assessor.get_full_name|default:assessment.assigned_assessor.username }}
                                {% else %}
                                    <span class="text-warning">{% trans "Not Assigned" %}</span>
                                {% endif %}
                            </td>
                            <td>
                                <span class="badge bg-secondary">
                                    {{ assessment.get_status_display|default:"N/A" }}
                                </span>
                            </td>
                            <td>{{ assessment.start_date|date:"Y-m-d"|default:"Not set" }}</td>
                            <td>
                                {# Placeholder for future actions like "Schedule Now" or "View Details" #}
                                <a href="#" class="btn btn-sm btn-outline-primary disabled" title="{% trans 'Manage Dates (Future)' %}">
                                    <i class="fas fa-calendar-alt"></i>
                                </a>
                                <a href="#" class="btn btn-sm btn-outline-info disabled" title="{% trans 'View Details (Future)' %}">
                                    <i class="fas fa-eye"></i>
                                </a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    {% if is_paginated %}
    <div class="mt-3">
        {% include "tracker/partials/pagination.html" %}
    </div>
    {% endif %}

    {% else %}
    <div class="alert alert-success mt-4" role="alert">
        <i class="fas fa-check-circle me-1"></i>
        {% trans "No assessments are currently awaiting scheduling." %}
    </div>
    {% endif %}

    <div class="mt-4">
        <a href="{% url 'tracker:admin_dashboard' %}" class="btn btn-secondary">
            <i class="fas fa-arrow-left me-1"></i> {% trans "Back to Admin Dashboard" %}
        </a>
    </div>
</div>
{% endblock %}